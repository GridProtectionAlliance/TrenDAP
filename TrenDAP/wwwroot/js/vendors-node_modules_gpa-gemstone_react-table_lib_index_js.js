(self["webpackChunktrendap"] = self["webpackChunktrendap"] || []).push([["vendors-node_modules_gpa-gemstone_react-table_lib_index_js"],{

/***/ "./node_modules/@gpa-gemstone/react-table/lib/DynamicTable.js":
/*!********************************************************************!*\
  !*** ./node_modules/@gpa-gemstone/react-table/lib/DynamicTable.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

// ******************************************************************************************************
//  DynamicTable.tsx - Gbtc
//
//  Copyright © 2021, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  07/26/2021 - Billy Ernest
//       Generated original version of source code.
//
// ******************************************************************************************************
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.DynamicTable = void 0;
var React = __webpack_require__(/*! react */ "./node_modules/react/index.js");
var Table_1 = __webpack_require__(/*! ./Table */ "./node_modules/@gpa-gemstone/react-table/lib/Table.js");
function DynamicTable(props) {
    if (props.data.length <= 0)
        return null;
    var cols = [];
    var keys = Object.keys(props.data[0]);
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        cols.push({ key: key, label: key, field: key });
    }
    return (React.createElement("table", { className: props.tableClass !== undefined ? props.tableClass : '', style: props.tableStyle },
        React.createElement(Table_1.Header, { Class: props.theadClass, Style: props.theadStyle, Cols: cols, SortKey: props.sortKey, Ascending: props.ascending, Click: function (d, e) { return handleSort(d, e); } }),
        React.createElement(Table_1.Rows, { Data: props.data, Cols: cols, RowStyle: props.rowStyle, BodyStyle: props.tbodyStyle, BodyClass: props.tbodyClass, Click: function (data, e) { return props.onClick(data, e); }, Selected: props.selected, KeySelector: props.keySelector })));
    function handleSort(data, event) {
        if (data.colKey !== null)
            props.onSort(data);
    }
}
exports.DynamicTable = DynamicTable;


/***/ }),

/***/ "./node_modules/@gpa-gemstone/react-table/lib/SearchableTable.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@gpa-gemstone/react-table/lib/SearchableTable.js ***!
  \***********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

// ******************************************************************************************************
//  SearchableTable.tsx - Gbtc
//
//  Copyright © 2021, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  07/12/2021 - C. Lackner
//       Generated original version of source code.
//
// ******************************************************************************************************
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SearchableTable = void 0;
var React = __webpack_require__(/*! react */ "./node_modules/react/index.js");
var Table_1 = __webpack_require__(/*! ./Table */ "./node_modules/@gpa-gemstone/react-table/lib/Table.js");
/**
 * A Table with an input Field to search on top
 */
function SearchableTable(props) {
    var _a = React.useState(props.data), data = _a[0], setData = _a[1];
    var _b = React.useState(''), searchTextAS = _b[0], setSearchTextAS = _b[1];
    React.useEffect(function () {
        setData(props.data.filter(function (s) { return props.matchSearch(s, searchTextAS); }));
    }, [props.data, searchTextAS]);
    return React.createElement(React.Fragment, null,
        React.createElement("input", { className: "form-control", placeholder: "Search filter for select box ...", value: searchTextAS, onChange: function (e) { return setSearchTextAS(e.target.value); } }),
        React.createElement(Table_1.default, __assign({}, props, { data: data })));
}
exports.SearchableTable = SearchableTable;


/***/ }),

/***/ "./node_modules/@gpa-gemstone/react-table/lib/SelectTable.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@gpa-gemstone/react-table/lib/SelectTable.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

// ******************************************************************************************************
//  SelectTable.tsx - Gbtc
//
//  Copyright © 2021, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  01/22/2021 - C. Lackner
//       Generated original version of source code.
//
// ******************************************************************************************************
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SelectTable = void 0;
var React = __webpack_require__(/*! react */ "./node_modules/react/index.js");
var _ = __webpack_require__(/*! lodash */ "./node_modules/lodash/lodash.js");
var Table_1 = __webpack_require__(/*! ./Table */ "./node_modules/@gpa-gemstone/react-table/lib/Table.js");
function SelectTable(props) {
    var didMountRef = React.useRef(false);
    var _a = React.useState(props.data), data = _a[0], setData = _a[1];
    var _b = React.useState([]), selected = _b[0], setSelected = _b[1];
    var _c = React.useState(props.sortKey), sortKey = _c[0], setSortKey = _c[1];
    var _d = React.useState(props.ascending), ascending = _d[0], setAscending = _d[1];
    React.useEffect(function () {
        if (didMountRef.current)
            selectAll();
        else
            didMountRef.current = true;
    }, [props.selectAllCounter]);
    React.useEffect(function () {
        if (props.data.length !== data.length)
            setData(props.data);
    }, [props.data]);
    React.useEffect(function () {
        setSelected(function (d) { return d.filter(function (keyItem) { return data.findIndex(function (item) { return item[props.KeyField] === keyItem; }) > -1; }); });
    }, [data]);
    React.useEffect(function () {
        var sortColumn = props.cols.filter(function (col) { return col.key === sortKey; })[0];
        if (sortColumn === undefined || sortColumn.field === undefined)
            return;
        var sortField = sortColumn.field;
        setData(function (lst) { return (_.orderBy(lst, [sortField], [(ascending ? "asc" : "desc")])); });
    }, [ascending, sortKey]);
    React.useEffect(function () {
        props.onSelection(data.filter(function (item) { return selected.findIndex(function (key) { return key === item[props.KeyField]; }) > -1; }));
    }, [selected]);
    function handleClick(d, event) {
        var sIndex = selected.findIndex(function (item) { return item === d.row[props.KeyField]; });
        if (sIndex === -1)
            setSelected(function (od) { return __spreadArray(__spreadArray([], od, true), [d.row[props.KeyField]], false); });
        else
            setSelected(function (od) { return od.filter(function (item) { return item !== d.row[props.KeyField]; }); });
    }
    function selectAll() {
        setSelected(function (d) { if (d.length === data.length)
            return [];
        else
            return data.map(function (row) { return row[props.KeyField]; }); });
    }
    function handleSort(d) {
        if (d.colKey === sortKey)
            setAscending(!ascending);
        else
            setSortKey(d.colKey);
    }
    var tableProps = {
        cols: __spreadArray([
            { key: 'gemstone-checkbox', field: props.KeyField, label: '', headerStyle: { width: '4em' }, rowStyle: { width: '4em' }, content: function (item, key, field, style) {
                    var index = selected.findIndex(function (i) { return i === item[props.KeyField]; });
                    if (index > -1)
                        return React.createElement("div", { style: { marginTop: '16px', textAlign: 'center' } },
                            React.createElement("i", { className: "fa fa-check-square-o fa-3x" }));
                    return null;
                } }
        ], props.cols, true),
        data: data,
        onClick: handleClick,
        sortKey: sortKey,
        ascending: ascending,
        onSort: handleSort,
        tableClass: props.tableClass,
        tableStyle: props.tableStyle,
        theadStyle: props.theadStyle,
        theadClass: props.theadClass,
        tbodyStyle: props.tbodyStyle,
        tbodyClass: props.tbodyClass,
        selected: function (d) { return false; },
        rowStyle: props.rowStyle
    };
    return React.createElement(Table_1.default, __assign({}, tableProps));
}
exports.SelectTable = SelectTable;


/***/ }),

/***/ "./node_modules/@gpa-gemstone/react-table/lib/Table.js":
/*!*************************************************************!*\
  !*** ./node_modules/@gpa-gemstone/react-table/lib/Table.js ***!
  \*************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

//  ******************************************************************************************************
//  Table.tsx - Gbtc
//
//  Copyright © 2018, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  08/02/2018 - Billy Ernest
//       Generated original version of source code.
//
//  ******************************************************************************************************
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Header = exports.Rows = void 0;
var React = __webpack_require__(/*! react */ "./node_modules/react/index.js");
function Table(props) {
    return (React.createElement("table", { className: props.tableClass !== undefined ? props.tableClass : '', style: props.tableStyle },
        React.createElement(Header, { Class: props.theadClass, Style: props.theadStyle, Cols: props.cols, SortKey: props.sortKey, Ascending: props.ascending, Click: function (d, e) { return handleSort(d, e); } }),
        React.createElement(Rows, { Data: props.data, Cols: props.cols, RowStyle: props.rowStyle, BodyStyle: props.tbodyStyle, BodyClass: props.tbodyClass, Click: function (data, e) { return props.onClick(data, e); }, Selected: props.selected, KeySelector: props.keySelector })));
    function handleSort(data, event) {
        if (data.colKey !== null)
            props.onSort(data);
    }
}
exports.default = Table;
function Rows(props) {
    if (props.Data.length === 0)
        return null;
    var rows = props.Data.map(function (item, rowIndex) {
        var cells = props.Cols.map(function (colData) {
            return React.createElement(Cell, { key: colData.key, Style: colData.rowStyle, DataKey: colData.key, DataField: colData.field, Object: item, RowIndex: rowIndex, Content: colData.content, Click: function (data, e) { return props.Click(data, e); } });
        });
        var style = (props.RowStyle !== undefined) ? __assign({}, props.RowStyle) : {};
        if (style.cursor === undefined)
            style.cursor = 'pointer';
        if (props.Selected !== undefined && props.Selected(item))
            style.backgroundColor = 'yellow';
        function ToKey(index, data) {
            if (props.KeySelector === undefined)
                return index.toString();
            return props.KeySelector(data);
        }
        return (React.createElement("tr", { style: style, key: ToKey(rowIndex, item) }, cells));
    });
    return (React.createElement("tbody", { style: props.BodyStyle, className: props.BodyClass }, rows));
}
exports.Rows = Rows;
function Cell(props) {
    var css = (props.Style !== undefined) ? __assign({}, props.Style) : {};
    var getFieldValue = function () { return props.DataField !== undefined ? props.Object[props.DataField] : null; };
    var getFieldContent = function () { return props.Content !== undefined ? props.Content(props.Object, props.DataKey, props.DataField, css, props.RowIndex) : getFieldValue(); };
    return (React.createElement("td", { style: css, onClick: function (e) { return props.Click({ colKey: props.DataKey, colField: props.DataField, row: props.Object, data: getFieldValue(), index: props.RowIndex }, e); } }, getFieldContent()));
}
function Header(props) {
    return (React.createElement("thead", { className: props.Class, style: props.Style },
        React.createElement("tr", null, props.Cols.map(function (col) { return React.createElement(HeaderCell, { key: col.key, HeaderStyle: col.headerStyle, DataKey: col.key, Click: function (e) { return props.Click({ colKey: col.key, colField: col.field, ascending: props.Ascending }, e); }, Label: col.label, SortKey: props.SortKey, Ascending: props.Ascending }); }))));
}
exports.Header = Header;
function HeaderCell(props) {
    var style = (props.HeaderStyle !== undefined) ? props.HeaderStyle : {};
    if (style.cursor === undefined && props.DataKey !== null) {
        style.cursor = 'pointer';
    }
    if (style.position === undefined) {
        style.position = 'relative';
    }
    return (React.createElement("th", { style: style, onClick: function (e) { return props.Click(e); } },
        React.createElement(RenderAngleIcon, { SortKey: props.SortKey, Key: props.DataKey, Ascending: props.Ascending }),
        React.createElement("div", { style: { marginLeft: 10 } }, props.Label)));
}
function RenderAngleIcon(props) {
    var AngleIcon = function () { return (React.createElement("div", { style: { position: 'absolute', top: 10, transform: (props.Ascending ? 'rotate(0deg)' : 'rotate(180deg)') } }, '^')); };
    if (props.SortKey === null)
        return null;
    if (props.SortKey !== props.Key)
        return null;
    return React.createElement(AngleIcon, { ascending: props.Ascending });
}
;


/***/ }),

/***/ "./node_modules/@gpa-gemstone/react-table/lib/index.js":
/*!*************************************************************!*\
  !*** ./node_modules/@gpa-gemstone/react-table/lib/index.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

//  ******************************************************************************************************
//  index.tsx - Gbtc
//
//  Copyright © 2018, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  08/02/2018 - Billy Ernest
//       Generated original version of source code.
//  02/12/2021 - C. lackner
//       Moved table to seperate File.
//
//  ******************************************************************************************************
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Rows = exports.DynamicTable = exports.SearchableTable = exports.SelectTable = void 0;
var Table_1 = __webpack_require__(/*! ./Table */ "./node_modules/@gpa-gemstone/react-table/lib/Table.js");
Object.defineProperty(exports, "Rows", ({ enumerable: true, get: function () { return Table_1.Rows; } }));
var SelectTable_1 = __webpack_require__(/*! ./SelectTable */ "./node_modules/@gpa-gemstone/react-table/lib/SelectTable.js");
Object.defineProperty(exports, "SelectTable", ({ enumerable: true, get: function () { return SelectTable_1.SelectTable; } }));
var SearchableTable_1 = __webpack_require__(/*! ./SearchableTable */ "./node_modules/@gpa-gemstone/react-table/lib/SearchableTable.js");
Object.defineProperty(exports, "SearchableTable", ({ enumerable: true, get: function () { return SearchableTable_1.SearchableTable; } }));
var DynamicTable_1 = __webpack_require__(/*! ./DynamicTable */ "./node_modules/@gpa-gemstone/react-table/lib/DynamicTable.js");
Object.defineProperty(exports, "DynamicTable", ({ enumerable: true, get: function () { return DynamicTable_1.DynamicTable; } }));
exports.default = Table_1.default;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmVuZGFwLy4vbm9kZV9tb2R1bGVzL0BncGEtZ2Vtc3RvbmUvcmVhY3QtdGFibGUvbGliL0R5bmFtaWNUYWJsZS5qcyIsIndlYnBhY2s6Ly90cmVuZGFwLy4vbm9kZV9tb2R1bGVzL0BncGEtZ2Vtc3RvbmUvcmVhY3QtdGFibGUvbGliL1NlYXJjaGFibGVUYWJsZS5qcyIsIndlYnBhY2s6Ly90cmVuZGFwLy4vbm9kZV9tb2R1bGVzL0BncGEtZ2Vtc3RvbmUvcmVhY3QtdGFibGUvbGliL1NlbGVjdFRhYmxlLmpzIiwid2VicGFjazovL3RyZW5kYXAvLi9ub2RlX21vZHVsZXMvQGdwYS1nZW1zdG9uZS9yZWFjdC10YWJsZS9saWIvVGFibGUuanMiLCJ3ZWJwYWNrOi8vdHJlbmRhcC8uL25vZGVfbW9kdWxlcy9AZ3BhLWdlbXN0b25lL3JlYWN0LXRhYmxlL2xpYi9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBNkMsQ0FBQyxjQUFjLEVBQUM7QUFDN0Qsb0JBQW9CO0FBQ3BCLFlBQVksbUJBQU8sQ0FBQyw0Q0FBTztBQUMzQixjQUFjLG1CQUFPLENBQUMsc0VBQVM7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxvQkFBb0I7QUFDdkQ7QUFDQSxtQkFBbUIsbUNBQW1DO0FBQ3REO0FBQ0EsMENBQTBDLDZGQUE2RjtBQUN2SSw2Q0FBNkMsMklBQTJJLHlCQUF5QixFQUFFLEVBQUU7QUFDck4sMkNBQTJDLDhJQUE4SSwrQkFBK0IsRUFBRSw0REFBNEQ7QUFDdFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjs7Ozs7Ozs7Ozs7O0FDNUNQO0FBQ2I7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Q0E7QUFDQSxpRkFBaUY7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBNkMsQ0FBQyxjQUFjLEVBQUM7QUFDN0QsWUFBWSxHQUFHLG9CQUFvQixHQUFHLHVCQUF1QixHQUFHLG1CQUFtQjtBQUNuRixjQUFjLG1CQUFPLENBQUMsc0VBQVM7QUFDL0Isd0NBQXVDLENBQUMscUNBQXFDLHFCQUFxQixFQUFFLEVBQUUsRUFBQztBQUN2RyxvQkFBb0IsbUJBQU8sQ0FBQyxrRkFBZTtBQUMzQywrQ0FBOEMsQ0FBQyxxQ0FBcUMsa0NBQWtDLEVBQUUsRUFBRSxFQUFDO0FBQzNILHdCQUF3QixtQkFBTyxDQUFDLDBGQUFtQjtBQUNuRCxtREFBa0QsQ0FBQyxxQ0FBcUMsMENBQTBDLEVBQUUsRUFBRSxFQUFDO0FBQ3ZJLHFCQUFxQixtQkFBTyxDQUFDLG9GQUFnQjtBQUM3QyxnREFBK0MsQ0FBQyxxQ0FBcUMsb0NBQW9DLEVBQUUsRUFBRSxFQUFDO0FBQzlILGVBQWUiLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZ3BhLWdlbXN0b25lX3JlYWN0LXRhYmxlX2xpYl9pbmRleF9qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuLy8gIER5bmFtaWNUYWJsZS50c3ggLSBHYnRjXHJcbi8vXHJcbi8vICBDb3B5cmlnaHQgwqkgMjAyMSwgR3JpZCBQcm90ZWN0aW9uIEFsbGlhbmNlLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuLy9cclxuLy8gIExpY2Vuc2VkIHRvIHRoZSBHcmlkIFByb3RlY3Rpb24gQWxsaWFuY2UgKEdQQSkgdW5kZXIgb25lIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiBTZWVcclxuLy8gIHRoZSBOT1RJQ0UgZmlsZSBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC5cclxuLy8gIFRoZSBHUEEgbGljZW5zZXMgdGhpcyBmaWxlIHRvIHlvdSB1bmRlciB0aGUgTUlUIExpY2Vuc2UgKE1JVCksIHRoZSBcIkxpY2Vuc2VcIjsgeW91IG1heSBub3QgdXNlIHRoaXNcclxuLy8gIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0OlxyXG4vL1xyXG4vLyAgICAgIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcclxuLy9cclxuLy8gIFVubGVzcyBhZ3JlZWQgdG8gaW4gd3JpdGluZywgdGhlIHN1YmplY3Qgc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cclxuLy8gIFwiQVMtSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFJlZmVyIHRvIHRoZVxyXG4vLyAgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMuXHJcbi8vXHJcbi8vICBDb2RlIE1vZGlmaWNhdGlvbiBIaXN0b3J5OlxyXG4vLyAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAgMDcvMjYvMjAyMSAtIEJpbGx5IEVybmVzdFxyXG4vLyAgICAgICBHZW5lcmF0ZWQgb3JpZ2luYWwgdmVyc2lvbiBvZiBzb3VyY2UgY29kZS5cclxuLy9cclxuLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5EeW5hbWljVGFibGUgPSB2b2lkIDA7XHJcbnZhciBSZWFjdCA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcclxudmFyIFRhYmxlXzEgPSByZXF1aXJlKFwiLi9UYWJsZVwiKTtcclxuZnVuY3Rpb24gRHluYW1pY1RhYmxlKHByb3BzKSB7XHJcbiAgICBpZiAocHJvcHMuZGF0YS5sZW5ndGggPD0gMClcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIHZhciBjb2xzID0gW107XHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHByb3BzLmRhdGFbMF0pO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga2V5ID0ga2V5c18xW19pXTtcclxuICAgICAgICBjb2xzLnB1c2goeyBrZXk6IGtleSwgbGFiZWw6IGtleSwgZmllbGQ6IGtleSB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChcInRhYmxlXCIsIHsgY2xhc3NOYW1lOiBwcm9wcy50YWJsZUNsYXNzICE9PSB1bmRlZmluZWQgPyBwcm9wcy50YWJsZUNsYXNzIDogJycsIHN0eWxlOiBwcm9wcy50YWJsZVN0eWxlIH0sXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChUYWJsZV8xLkhlYWRlciwgeyBDbGFzczogcHJvcHMudGhlYWRDbGFzcywgU3R5bGU6IHByb3BzLnRoZWFkU3R5bGUsIENvbHM6IGNvbHMsIFNvcnRLZXk6IHByb3BzLnNvcnRLZXksIEFzY2VuZGluZzogcHJvcHMuYXNjZW5kaW5nLCBDbGljazogZnVuY3Rpb24gKGQsIGUpIHsgcmV0dXJuIGhhbmRsZVNvcnQoZCwgZSk7IH0gfSksXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChUYWJsZV8xLlJvd3MsIHsgRGF0YTogcHJvcHMuZGF0YSwgQ29sczogY29scywgUm93U3R5bGU6IHByb3BzLnJvd1N0eWxlLCBCb2R5U3R5bGU6IHByb3BzLnRib2R5U3R5bGUsIEJvZHlDbGFzczogcHJvcHMudGJvZHlDbGFzcywgQ2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBlKSB7IHJldHVybiBwcm9wcy5vbkNsaWNrKGRhdGEsIGUpOyB9LCBTZWxlY3RlZDogcHJvcHMuc2VsZWN0ZWQsIEtleVNlbGVjdG9yOiBwcm9wcy5rZXlTZWxlY3RvciB9KSkpO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlU29ydChkYXRhLCBldmVudCkge1xyXG4gICAgICAgIGlmIChkYXRhLmNvbEtleSAhPT0gbnVsbClcclxuICAgICAgICAgICAgcHJvcHMub25Tb3J0KGRhdGEpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuRHluYW1pY1RhYmxlID0gRHluYW1pY1RhYmxlO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbi8vICBTZWFyY2hhYmxlVGFibGUudHN4IC0gR2J0Y1xyXG4vL1xyXG4vLyAgQ29weXJpZ2h0IMKpIDIwMjEsIEdyaWQgUHJvdGVjdGlvbiBBbGxpYW5jZS4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbi8vXHJcbi8vICBMaWNlbnNlZCB0byB0aGUgR3JpZCBQcm90ZWN0aW9uIEFsbGlhbmNlIChHUEEpIHVuZGVyIG9uZSBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gU2VlXHJcbi8vICB0aGUgTk9USUNFIGZpbGUgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuXHJcbi8vICBUaGUgR1BBIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIgdGhlIE1JVCBMaWNlbnNlIChNSVQpLCB0aGUgXCJMaWNlbnNlXCI7IHlvdSBtYXkgbm90IHVzZSB0aGlzXHJcbi8vICBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdDpcclxuLy9cclxuLy8gICAgICBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUXHJcbi8vXHJcbi8vICBVbmxlc3MgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHRoZSBzdWJqZWN0IHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXHJcbi8vICBcIkFTLUlTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBSZWZlciB0byB0aGVcclxuLy8gIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zLlxyXG4vL1xyXG4vLyAgQ29kZSBNb2RpZmljYXRpb24gSGlzdG9yeTpcclxuLy8gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gIDA3LzEyLzIwMjEgLSBDLiBMYWNrbmVyXHJcbi8vICAgICAgIEdlbmVyYXRlZCBvcmlnaW5hbCB2ZXJzaW9uIG9mIHNvdXJjZSBjb2RlLlxyXG4vL1xyXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxyXG4gICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuU2VhcmNoYWJsZVRhYmxlID0gdm9pZCAwO1xyXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XHJcbnZhciBUYWJsZV8xID0gcmVxdWlyZShcIi4vVGFibGVcIik7XHJcbi8qKlxyXG4gKiBBIFRhYmxlIHdpdGggYW4gaW5wdXQgRmllbGQgdG8gc2VhcmNoIG9uIHRvcFxyXG4gKi9cclxuZnVuY3Rpb24gU2VhcmNoYWJsZVRhYmxlKHByb3BzKSB7XHJcbiAgICB2YXIgX2EgPSBSZWFjdC51c2VTdGF0ZShwcm9wcy5kYXRhKSwgZGF0YSA9IF9hWzBdLCBzZXREYXRhID0gX2FbMV07XHJcbiAgICB2YXIgX2IgPSBSZWFjdC51c2VTdGF0ZSgnJyksIHNlYXJjaFRleHRBUyA9IF9iWzBdLCBzZXRTZWFyY2hUZXh0QVMgPSBfYlsxXTtcclxuICAgIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2V0RGF0YShwcm9wcy5kYXRhLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcHJvcHMubWF0Y2hTZWFyY2gocywgc2VhcmNoVGV4dEFTKTsgfSkpO1xyXG4gICAgfSwgW3Byb3BzLmRhdGEsIHNlYXJjaFRleHRBU10pO1xyXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHsgY2xhc3NOYW1lOiBcImZvcm0tY29udHJvbFwiLCBwbGFjZWhvbGRlcjogXCJTZWFyY2ggZmlsdGVyIGZvciBzZWxlY3QgYm94IC4uLlwiLCB2YWx1ZTogc2VhcmNoVGV4dEFTLCBvbkNoYW5nZTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHNldFNlYXJjaFRleHRBUyhlLnRhcmdldC52YWx1ZSk7IH0gfSksXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChUYWJsZV8xLmRlZmF1bHQsIF9fYXNzaWduKHt9LCBwcm9wcywgeyBkYXRhOiBkYXRhIH0pKSk7XHJcbn1cclxuZXhwb3J0cy5TZWFyY2hhYmxlVGFibGUgPSBTZWFyY2hhYmxlVGFibGU7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuLy8gIFNlbGVjdFRhYmxlLnRzeCAtIEdidGNcclxuLy9cclxuLy8gIENvcHlyaWdodCDCqSAyMDIxLCBHcmlkIFByb3RlY3Rpb24gQWxsaWFuY2UuICBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4vL1xyXG4vLyAgTGljZW5zZWQgdG8gdGhlIEdyaWQgUHJvdGVjdGlvbiBBbGxpYW5jZSAoR1BBKSB1bmRlciBvbmUgb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuIFNlZVxyXG4vLyAgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLlxyXG4vLyAgVGhlIEdQQSBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgTGljZW5zZSAoTUlUKSwgdGhlIFwiTGljZW5zZVwiOyB5b3UgbWF5IG5vdCB1c2UgdGhpc1xyXG4vLyAgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQ6XHJcbi8vXHJcbi8vICAgICAgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxyXG4vL1xyXG4vLyAgVW5sZXNzIGFncmVlZCB0byBpbiB3cml0aW5nLCB0aGUgc3ViamVjdCBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxyXG4vLyAgXCJBUy1JU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gUmVmZXIgdG8gdGhlXHJcbi8vICBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucy5cclxuLy9cclxuLy8gIENvZGUgTW9kaWZpY2F0aW9uIEhpc3Rvcnk6XHJcbi8vICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vICAwMS8yMi8yMDIxIC0gQy4gTGFja25lclxyXG4vLyAgICAgICBHZW5lcmF0ZWQgb3JpZ2luYWwgdmVyc2lvbiBvZiBzb3VyY2UgY29kZS5cclxuLy9cclxuLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcclxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLlNlbGVjdFRhYmxlID0gdm9pZCAwO1xyXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XHJcbnZhciBfID0gcmVxdWlyZShcImxvZGFzaFwiKTtcclxudmFyIFRhYmxlXzEgPSByZXF1aXJlKFwiLi9UYWJsZVwiKTtcclxuZnVuY3Rpb24gU2VsZWN0VGFibGUocHJvcHMpIHtcclxuICAgIHZhciBkaWRNb3VudFJlZiA9IFJlYWN0LnVzZVJlZihmYWxzZSk7XHJcbiAgICB2YXIgX2EgPSBSZWFjdC51c2VTdGF0ZShwcm9wcy5kYXRhKSwgZGF0YSA9IF9hWzBdLCBzZXREYXRhID0gX2FbMV07XHJcbiAgICB2YXIgX2IgPSBSZWFjdC51c2VTdGF0ZShbXSksIHNlbGVjdGVkID0gX2JbMF0sIHNldFNlbGVjdGVkID0gX2JbMV07XHJcbiAgICB2YXIgX2MgPSBSZWFjdC51c2VTdGF0ZShwcm9wcy5zb3J0S2V5KSwgc29ydEtleSA9IF9jWzBdLCBzZXRTb3J0S2V5ID0gX2NbMV07XHJcbiAgICB2YXIgX2QgPSBSZWFjdC51c2VTdGF0ZShwcm9wcy5hc2NlbmRpbmcpLCBhc2NlbmRpbmcgPSBfZFswXSwgc2V0QXNjZW5kaW5nID0gX2RbMV07XHJcbiAgICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChkaWRNb3VudFJlZi5jdXJyZW50KVxyXG4gICAgICAgICAgICBzZWxlY3RBbGwoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGRpZE1vdW50UmVmLmN1cnJlbnQgPSB0cnVlO1xyXG4gICAgfSwgW3Byb3BzLnNlbGVjdEFsbENvdW50ZXJdKTtcclxuICAgIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHByb3BzLmRhdGEubGVuZ3RoICE9PSBkYXRhLmxlbmd0aClcclxuICAgICAgICAgICAgc2V0RGF0YShwcm9wcy5kYXRhKTtcclxuICAgIH0sIFtwcm9wcy5kYXRhXSk7XHJcbiAgICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNldFNlbGVjdGVkKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmZpbHRlcihmdW5jdGlvbiAoa2V5SXRlbSkgeyByZXR1cm4gZGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGl0ZW1bcHJvcHMuS2V5RmllbGRdID09PSBrZXlJdGVtOyB9KSA+IC0xOyB9KTsgfSk7XHJcbiAgICB9LCBbZGF0YV0pO1xyXG4gICAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc29ydENvbHVtbiA9IHByb3BzLmNvbHMuZmlsdGVyKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIGNvbC5rZXkgPT09IHNvcnRLZXk7IH0pWzBdO1xyXG4gICAgICAgIGlmIChzb3J0Q29sdW1uID09PSB1bmRlZmluZWQgfHwgc29ydENvbHVtbi5maWVsZCA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdmFyIHNvcnRGaWVsZCA9IHNvcnRDb2x1bW4uZmllbGQ7XHJcbiAgICAgICAgc2V0RGF0YShmdW5jdGlvbiAobHN0KSB7IHJldHVybiAoXy5vcmRlckJ5KGxzdCwgW3NvcnRGaWVsZF0sIFsoYXNjZW5kaW5nID8gXCJhc2NcIiA6IFwiZGVzY1wiKV0pKTsgfSk7XHJcbiAgICB9LCBbYXNjZW5kaW5nLCBzb3J0S2V5XSk7XHJcbiAgICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHByb3BzLm9uU2VsZWN0aW9uKGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBzZWxlY3RlZC5maW5kSW5kZXgoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4ga2V5ID09PSBpdGVtW3Byb3BzLktleUZpZWxkXTsgfSkgPiAtMTsgfSkpO1xyXG4gICAgfSwgW3NlbGVjdGVkXSk7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVDbGljayhkLCBldmVudCkge1xyXG4gICAgICAgIHZhciBzSW5kZXggPSBzZWxlY3RlZC5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGl0ZW0gPT09IGQucm93W3Byb3BzLktleUZpZWxkXTsgfSk7XHJcbiAgICAgICAgaWYgKHNJbmRleCA9PT0gLTEpXHJcbiAgICAgICAgICAgIHNldFNlbGVjdGVkKGZ1bmN0aW9uIChvZCkgeyByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBvZCwgdHJ1ZSksIFtkLnJvd1twcm9wcy5LZXlGaWVsZF1dLCBmYWxzZSk7IH0pO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgc2V0U2VsZWN0ZWQoZnVuY3Rpb24gKG9kKSB7IHJldHVybiBvZC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGl0ZW0gIT09IGQucm93W3Byb3BzLktleUZpZWxkXTsgfSk7IH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gc2VsZWN0QWxsKCkge1xyXG4gICAgICAgIHNldFNlbGVjdGVkKGZ1bmN0aW9uIChkKSB7IGlmIChkLmxlbmd0aCA9PT0gZGF0YS5sZW5ndGgpXHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLm1hcChmdW5jdGlvbiAocm93KSB7IHJldHVybiByb3dbcHJvcHMuS2V5RmllbGRdOyB9KTsgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVTb3J0KGQpIHtcclxuICAgICAgICBpZiAoZC5jb2xLZXkgPT09IHNvcnRLZXkpXHJcbiAgICAgICAgICAgIHNldEFzY2VuZGluZyghYXNjZW5kaW5nKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHNldFNvcnRLZXkoZC5jb2xLZXkpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRhYmxlUHJvcHMgPSB7XHJcbiAgICAgICAgY29sczogX19zcHJlYWRBcnJheShbXHJcbiAgICAgICAgICAgIHsga2V5OiAnZ2Vtc3RvbmUtY2hlY2tib3gnLCBmaWVsZDogcHJvcHMuS2V5RmllbGQsIGxhYmVsOiAnJywgaGVhZGVyU3R5bGU6IHsgd2lkdGg6ICc0ZW0nIH0sIHJvd1N0eWxlOiB7IHdpZHRoOiAnNGVtJyB9LCBjb250ZW50OiBmdW5jdGlvbiAoaXRlbSwga2V5LCBmaWVsZCwgc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBzZWxlY3RlZC5maW5kSW5kZXgoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIGkgPT09IGl0ZW1bcHJvcHMuS2V5RmllbGRdOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBzdHlsZTogeyBtYXJnaW5Ub3A6ICcxNnB4JywgdGV4dEFsaWduOiAnY2VudGVyJyB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaVwiLCB7IGNsYXNzTmFtZTogXCJmYSBmYS1jaGVjay1zcXVhcmUtbyBmYS0zeFwiIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH0gfVxyXG4gICAgICAgIF0sIHByb3BzLmNvbHMsIHRydWUpLFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgb25DbGljazogaGFuZGxlQ2xpY2ssXHJcbiAgICAgICAgc29ydEtleTogc29ydEtleSxcclxuICAgICAgICBhc2NlbmRpbmc6IGFzY2VuZGluZyxcclxuICAgICAgICBvblNvcnQ6IGhhbmRsZVNvcnQsXHJcbiAgICAgICAgdGFibGVDbGFzczogcHJvcHMudGFibGVDbGFzcyxcclxuICAgICAgICB0YWJsZVN0eWxlOiBwcm9wcy50YWJsZVN0eWxlLFxyXG4gICAgICAgIHRoZWFkU3R5bGU6IHByb3BzLnRoZWFkU3R5bGUsXHJcbiAgICAgICAgdGhlYWRDbGFzczogcHJvcHMudGhlYWRDbGFzcyxcclxuICAgICAgICB0Ym9keVN0eWxlOiBwcm9wcy50Ym9keVN0eWxlLFxyXG4gICAgICAgIHRib2R5Q2xhc3M6IHByb3BzLnRib2R5Q2xhc3MsXHJcbiAgICAgICAgc2VsZWN0ZWQ6IGZ1bmN0aW9uIChkKSB7IHJldHVybiBmYWxzZTsgfSxcclxuICAgICAgICByb3dTdHlsZTogcHJvcHMucm93U3R5bGVcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChUYWJsZV8xLmRlZmF1bHQsIF9fYXNzaWduKHt9LCB0YWJsZVByb3BzKSk7XHJcbn1cclxuZXhwb3J0cy5TZWxlY3RUYWJsZSA9IFNlbGVjdFRhYmxlO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuLy8gICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4vLyAgVGFibGUudHN4IC0gR2J0Y1xyXG4vL1xyXG4vLyAgQ29weXJpZ2h0IMKpIDIwMTgsIEdyaWQgUHJvdGVjdGlvbiBBbGxpYW5jZS4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbi8vXHJcbi8vICBMaWNlbnNlZCB0byB0aGUgR3JpZCBQcm90ZWN0aW9uIEFsbGlhbmNlIChHUEEpIHVuZGVyIG9uZSBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gU2VlXHJcbi8vICB0aGUgTk9USUNFIGZpbGUgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuXHJcbi8vICBUaGUgR1BBIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIgdGhlIE1JVCBMaWNlbnNlIChNSVQpLCB0aGUgXCJMaWNlbnNlXCI7IHlvdSBtYXkgbm90IHVzZSB0aGlzXHJcbi8vICBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdDpcclxuLy9cclxuLy8gICAgICBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUXHJcbi8vXHJcbi8vICBVbmxlc3MgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHRoZSBzdWJqZWN0IHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXHJcbi8vICBcIkFTLUlTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBSZWZlciB0byB0aGVcclxuLy8gIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zLlxyXG4vL1xyXG4vLyAgQ29kZSBNb2RpZmljYXRpb24gSGlzdG9yeTpcclxuLy8gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gIDA4LzAyLzIwMTggLSBCaWxseSBFcm5lc3RcclxuLy8gICAgICAgR2VuZXJhdGVkIG9yaWdpbmFsIHZlcnNpb24gb2Ygc291cmNlIGNvZGUuXHJcbi8vXHJcbi8vICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxyXG4gICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuSGVhZGVyID0gZXhwb3J0cy5Sb3dzID0gdm9pZCAwO1xyXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XHJcbmZ1bmN0aW9uIFRhYmxlKHByb3BzKSB7XHJcbiAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZVwiLCB7IGNsYXNzTmFtZTogcHJvcHMudGFibGVDbGFzcyAhPT0gdW5kZWZpbmVkID8gcHJvcHMudGFibGVDbGFzcyA6ICcnLCBzdHlsZTogcHJvcHMudGFibGVTdHlsZSB9LFxyXG4gICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoSGVhZGVyLCB7IENsYXNzOiBwcm9wcy50aGVhZENsYXNzLCBTdHlsZTogcHJvcHMudGhlYWRTdHlsZSwgQ29sczogcHJvcHMuY29scywgU29ydEtleTogcHJvcHMuc29ydEtleSwgQXNjZW5kaW5nOiBwcm9wcy5hc2NlbmRpbmcsIENsaWNrOiBmdW5jdGlvbiAoZCwgZSkgeyByZXR1cm4gaGFuZGxlU29ydChkLCBlKTsgfSB9KSxcclxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFJvd3MsIHsgRGF0YTogcHJvcHMuZGF0YSwgQ29sczogcHJvcHMuY29scywgUm93U3R5bGU6IHByb3BzLnJvd1N0eWxlLCBCb2R5U3R5bGU6IHByb3BzLnRib2R5U3R5bGUsIEJvZHlDbGFzczogcHJvcHMudGJvZHlDbGFzcywgQ2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBlKSB7IHJldHVybiBwcm9wcy5vbkNsaWNrKGRhdGEsIGUpOyB9LCBTZWxlY3RlZDogcHJvcHMuc2VsZWN0ZWQsIEtleVNlbGVjdG9yOiBwcm9wcy5rZXlTZWxlY3RvciB9KSkpO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlU29ydChkYXRhLCBldmVudCkge1xyXG4gICAgICAgIGlmIChkYXRhLmNvbEtleSAhPT0gbnVsbClcclxuICAgICAgICAgICAgcHJvcHMub25Tb3J0KGRhdGEpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuZGVmYXVsdCA9IFRhYmxlO1xyXG5mdW5jdGlvbiBSb3dzKHByb3BzKSB7XHJcbiAgICBpZiAocHJvcHMuRGF0YS5sZW5ndGggPT09IDApXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB2YXIgcm93cyA9IHByb3BzLkRhdGEubWFwKGZ1bmN0aW9uIChpdGVtLCByb3dJbmRleCkge1xyXG4gICAgICAgIHZhciBjZWxscyA9IHByb3BzLkNvbHMubWFwKGZ1bmN0aW9uIChjb2xEYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KENlbGwsIHsga2V5OiBjb2xEYXRhLmtleSwgU3R5bGU6IGNvbERhdGEucm93U3R5bGUsIERhdGFLZXk6IGNvbERhdGEua2V5LCBEYXRhRmllbGQ6IGNvbERhdGEuZmllbGQsIE9iamVjdDogaXRlbSwgUm93SW5kZXg6IHJvd0luZGV4LCBDb250ZW50OiBjb2xEYXRhLmNvbnRlbnQsIENsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZSkgeyByZXR1cm4gcHJvcHMuQ2xpY2soZGF0YSwgZSk7IH0gfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHN0eWxlID0gKHByb3BzLlJvd1N0eWxlICE9PSB1bmRlZmluZWQpID8gX19hc3NpZ24oe30sIHByb3BzLlJvd1N0eWxlKSA6IHt9O1xyXG4gICAgICAgIGlmIChzdHlsZS5jdXJzb3IgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgIGlmIChwcm9wcy5TZWxlY3RlZCAhPT0gdW5kZWZpbmVkICYmIHByb3BzLlNlbGVjdGVkKGl0ZW0pKVxyXG4gICAgICAgICAgICBzdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAneWVsbG93JztcclxuICAgICAgICBmdW5jdGlvbiBUb0tleShpbmRleCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAocHJvcHMuS2V5U2VsZWN0b3IgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleC50b1N0cmluZygpO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvcHMuS2V5U2VsZWN0b3IoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChcInRyXCIsIHsgc3R5bGU6IHN0eWxlLCBrZXk6IFRvS2V5KHJvd0luZGV4LCBpdGVtKSB9LCBjZWxscykpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiLCB7IHN0eWxlOiBwcm9wcy5Cb2R5U3R5bGUsIGNsYXNzTmFtZTogcHJvcHMuQm9keUNsYXNzIH0sIHJvd3MpKTtcclxufVxyXG5leHBvcnRzLlJvd3MgPSBSb3dzO1xyXG5mdW5jdGlvbiBDZWxsKHByb3BzKSB7XHJcbiAgICB2YXIgY3NzID0gKHByb3BzLlN0eWxlICE9PSB1bmRlZmluZWQpID8gX19hc3NpZ24oe30sIHByb3BzLlN0eWxlKSA6IHt9O1xyXG4gICAgdmFyIGdldEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBwcm9wcy5EYXRhRmllbGQgIT09IHVuZGVmaW5lZCA/IHByb3BzLk9iamVjdFtwcm9wcy5EYXRhRmllbGRdIDogbnVsbDsgfTtcclxuICAgIHZhciBnZXRGaWVsZENvbnRlbnQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBwcm9wcy5Db250ZW50ICE9PSB1bmRlZmluZWQgPyBwcm9wcy5Db250ZW50KHByb3BzLk9iamVjdCwgcHJvcHMuRGF0YUtleSwgcHJvcHMuRGF0YUZpZWxkLCBjc3MsIHByb3BzLlJvd0luZGV4KSA6IGdldEZpZWxkVmFsdWUoKTsgfTtcclxuICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChcInRkXCIsIHsgc3R5bGU6IGNzcywgb25DbGljazogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHByb3BzLkNsaWNrKHsgY29sS2V5OiBwcm9wcy5EYXRhS2V5LCBjb2xGaWVsZDogcHJvcHMuRGF0YUZpZWxkLCByb3c6IHByb3BzLk9iamVjdCwgZGF0YTogZ2V0RmllbGRWYWx1ZSgpLCBpbmRleDogcHJvcHMuUm93SW5kZXggfSwgZSk7IH0gfSwgZ2V0RmllbGRDb250ZW50KCkpKTtcclxufVxyXG5mdW5jdGlvbiBIZWFkZXIocHJvcHMpIHtcclxuICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChcInRoZWFkXCIsIHsgY2xhc3NOYW1lOiBwcm9wcy5DbGFzcywgc3R5bGU6IHByb3BzLlN0eWxlIH0sXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInRyXCIsIG51bGwsIHByb3BzLkNvbHMubWFwKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoSGVhZGVyQ2VsbCwgeyBrZXk6IGNvbC5rZXksIEhlYWRlclN0eWxlOiBjb2wuaGVhZGVyU3R5bGUsIERhdGFLZXk6IGNvbC5rZXksIENsaWNrOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gcHJvcHMuQ2xpY2soeyBjb2xLZXk6IGNvbC5rZXksIGNvbEZpZWxkOiBjb2wuZmllbGQsIGFzY2VuZGluZzogcHJvcHMuQXNjZW5kaW5nIH0sIGUpOyB9LCBMYWJlbDogY29sLmxhYmVsLCBTb3J0S2V5OiBwcm9wcy5Tb3J0S2V5LCBBc2NlbmRpbmc6IHByb3BzLkFzY2VuZGluZyB9KTsgfSkpKSk7XHJcbn1cclxuZXhwb3J0cy5IZWFkZXIgPSBIZWFkZXI7XHJcbmZ1bmN0aW9uIEhlYWRlckNlbGwocHJvcHMpIHtcclxuICAgIHZhciBzdHlsZSA9IChwcm9wcy5IZWFkZXJTdHlsZSAhPT0gdW5kZWZpbmVkKSA/IHByb3BzLkhlYWRlclN0eWxlIDoge307XHJcbiAgICBpZiAoc3R5bGUuY3Vyc29yID09PSB1bmRlZmluZWQgJiYgcHJvcHMuRGF0YUtleSAhPT0gbnVsbCkge1xyXG4gICAgICAgIHN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgIH1cclxuICAgIGlmIChzdHlsZS5wb3NpdGlvbiA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KFwidGhcIiwgeyBzdHlsZTogc3R5bGUsIG9uQ2xpY2s6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBwcm9wcy5DbGljayhlKTsgfSB9LFxyXG4gICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVuZGVyQW5nbGVJY29uLCB7IFNvcnRLZXk6IHByb3BzLlNvcnRLZXksIEtleTogcHJvcHMuRGF0YUtleSwgQXNjZW5kaW5nOiBwcm9wcy5Bc2NlbmRpbmcgfSksXHJcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IHN0eWxlOiB7IG1hcmdpbkxlZnQ6IDEwIH0gfSwgcHJvcHMuTGFiZWwpKSk7XHJcbn1cclxuZnVuY3Rpb24gUmVuZGVyQW5nbGVJY29uKHByb3BzKSB7XHJcbiAgICB2YXIgQW5nbGVJY29uID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBzdHlsZTogeyBwb3NpdGlvbjogJ2Fic29sdXRlJywgdG9wOiAxMCwgdHJhbnNmb3JtOiAocHJvcHMuQXNjZW5kaW5nID8gJ3JvdGF0ZSgwZGVnKScgOiAncm90YXRlKDE4MGRlZyknKSB9IH0sICdeJykpOyB9O1xyXG4gICAgaWYgKHByb3BzLlNvcnRLZXkgPT09IG51bGwpXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAocHJvcHMuU29ydEtleSAhPT0gcHJvcHMuS2V5KVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQW5nbGVJY29uLCB7IGFzY2VuZGluZzogcHJvcHMuQXNjZW5kaW5nIH0pO1xyXG59XHJcbjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8vICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuLy8gIGluZGV4LnRzeCAtIEdidGNcclxuLy9cclxuLy8gIENvcHlyaWdodCDCqSAyMDE4LCBHcmlkIFByb3RlY3Rpb24gQWxsaWFuY2UuICBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4vL1xyXG4vLyAgTGljZW5zZWQgdG8gdGhlIEdyaWQgUHJvdGVjdGlvbiBBbGxpYW5jZSAoR1BBKSB1bmRlciBvbmUgb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuIFNlZVxyXG4vLyAgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLlxyXG4vLyAgVGhlIEdQQSBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBNSVQgTGljZW5zZSAoTUlUKSwgdGhlIFwiTGljZW5zZVwiOyB5b3UgbWF5IG5vdCB1c2UgdGhpc1xyXG4vLyAgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQ6XHJcbi8vXHJcbi8vICAgICAgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxyXG4vL1xyXG4vLyAgVW5sZXNzIGFncmVlZCB0byBpbiB3cml0aW5nLCB0aGUgc3ViamVjdCBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxyXG4vLyAgXCJBUy1JU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gUmVmZXIgdG8gdGhlXHJcbi8vICBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucy5cclxuLy9cclxuLy8gIENvZGUgTW9kaWZpY2F0aW9uIEhpc3Rvcnk6XHJcbi8vICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vICAwOC8wMi8yMDE4IC0gQmlsbHkgRXJuZXN0XHJcbi8vICAgICAgIEdlbmVyYXRlZCBvcmlnaW5hbCB2ZXJzaW9uIG9mIHNvdXJjZSBjb2RlLlxyXG4vLyAgMDIvMTIvMjAyMSAtIEMuIGxhY2tuZXJcclxuLy8gICAgICAgTW92ZWQgdGFibGUgdG8gc2VwZXJhdGUgRmlsZS5cclxuLy9cclxuLy8gICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuUm93cyA9IGV4cG9ydHMuRHluYW1pY1RhYmxlID0gZXhwb3J0cy5TZWFyY2hhYmxlVGFibGUgPSBleHBvcnRzLlNlbGVjdFRhYmxlID0gdm9pZCAwO1xyXG52YXIgVGFibGVfMSA9IHJlcXVpcmUoXCIuL1RhYmxlXCIpO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJSb3dzXCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBUYWJsZV8xLlJvd3M7IH0gfSk7XHJcbnZhciBTZWxlY3RUYWJsZV8xID0gcmVxdWlyZShcIi4vU2VsZWN0VGFibGVcIik7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNlbGVjdFRhYmxlXCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBTZWxlY3RUYWJsZV8xLlNlbGVjdFRhYmxlOyB9IH0pO1xyXG52YXIgU2VhcmNoYWJsZVRhYmxlXzEgPSByZXF1aXJlKFwiLi9TZWFyY2hhYmxlVGFibGVcIik7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNlYXJjaGFibGVUYWJsZVwiLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gU2VhcmNoYWJsZVRhYmxlXzEuU2VhcmNoYWJsZVRhYmxlOyB9IH0pO1xyXG52YXIgRHluYW1pY1RhYmxlXzEgPSByZXF1aXJlKFwiLi9EeW5hbWljVGFibGVcIik7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkR5bmFtaWNUYWJsZVwiLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gRHluYW1pY1RhYmxlXzEuRHluYW1pY1RhYmxlOyB9IH0pO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBUYWJsZV8xLmRlZmF1bHQ7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=